paths:
  /backends/saml:
    delete:
      description: '**Required ACL:** `auth.backends.saml.delete`'
      operationId: deleteSAMLBackendConfig
      parameters:
      - $ref: '#/parameters/tenantuuid'
      responses:
        '204':
          description: The SAML backend configuration has been deleted
        '401':
          description: Unauthorized
          schema:
            $ref: '#/definitions/Error'
        '404':
          description: Configuration for the tenant not found
          schema:
            $ref: '#/definitions/Error'
        '500':
          description: Internal Server Error
          schema:
            $ref: '#/definitions/Error'
      security:
      - wazo_auth_token: []
      summary: Delete current tenant's SAML backend configuration
      tags:
      - backends
    get:
      description: '**Required ACL:** `auth.backends.saml.read`'
      operationId: getSAMLBackendConfig
      parameters:
      - $ref: '#/parameters/tenantuuid'
      produces:
      - application/json
      responses:
        '200':
          description: The SAML backend configuration and the metadata XML file.
          schema:
            $ref: '#/definitions/SAMLBackendConfig'
        '401':
          description: Unauthorized
          schema:
            $ref: '#/definitions/Error'
        '500':
          description: Internal Server Error
          schema:
            $ref: '#/definitions/Error'
      security:
      - wazo_auth_token: []
      summary: 'Get current tenant''s SAML backend configuration. If there is no configuration,

        all the fields will be `null`.

        '
      tags:
      - backends
    put:
      description: '**Required ACL:** `auth.backends.saml.update'
      operationId: updateSAMLBackendConfig
      consumes:
        - multipart/form-data
      parameters:
        - $ref: '#/parameters/tenantuuid'
        - in: formData
          name: metadata
          type: file
          description: The IDP metadata file in XML format.
          x-mimetype: application/xml
        - in: formData
          name: domain_uuid
          type: string
          description: The UUID of the domain to use for the SAML backend.
        - in: formData
          name: entity_id
          type: string
          description: The name of the SAML Entity.
      produces:
      - application/json
      responses:
        '200':
          description: The SAML backend configuration has been updated
          schema:
            $ref: '#/definitions/SAMLBackendConfig'
        '401':
          description: Unauthorized
          schema:
            $ref: '#/definitions/Error'
        '500':
          description: 'Internal server error'
          schema:
            $ref: '#/definitions/Error'
      security:
      - wazo_auth_token: []
      summary: Update current tenant's SAML backend configuration
      tags:
      - backends
  /backends/saml/metadata:
    get:
      description: '**Required ACL:** `auth.backends.saml.read`


        This endpoint allow to download tenant metadata file.

        '
      parameters:
      - $ref: '#/parameters/tenantuuid'
      responses:
        '200':
          description: Download the tenant SAML metadata XML file.
          schema:
            description: The  metadata file in XML format.
            type: file
            x-mimetype: application/xml
        '401':
          description: Unauthorized
          schema:
            $ref: '#/definitions/Error'
        '404':
          description: 'No metadata file found'
          schema:
            $ref: '#/definitions/Error'
        '500':
          description: 'Internal server error'
          schema:
            $ref: '#/definitions/Error'
      summary: Download the tenant's SAML metadata XML file.
      tags:
      - backends
  /backends/saml/acs:
    get:
      description: '**Required ACL:** `auth.backends.saml.read`


        This endpoint provides the tenant Assertion Consumer Service URL.

        '
      parameters:
      - $ref: '#/parameters/tenantuuid'
      produces:
      - application/json
      responses:
        '200':
          description: Returns the URL to be used while configuring the Identity provider.
          schema:
            $ref: '#/definitions/SAMLAcsUrl'
        '401':
          description: Unauthorized
          schema:
            $ref: '#/definitions/Error'
        '404':
          description: SAML backend is not enabled
          schema:
            $ref: '#/definitions/Error'
        '500':
          description: 'Internal server error'
          schema:
            $ref: '#/definitions/Error'
      summary: Get tenant's ACS URL to use in the IDP configuration
      tags:
      - backends


definitions:
  SAMLBackendConfig:
    properties:
      domain_uuid:
        type: string
        description: The UUID of the domain to use for the SAML backend.
      entity_id:
        type: string
        description: The name of the SAML Entity Id
    required:
    - domain_uuid
    - entity_id
    type: object
  SAMLAcsUrl:
    properties:
      acs_url:
        type: string
        description: The SAML ACS URL
        format: uri
    required:
    - acs_url
    type: object
